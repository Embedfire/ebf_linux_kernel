/*
 * Copyright (C) 2019 - All Rights Reserved by 
 * filename : imx-fire-uart3-overlay.dts
 * brief : Device Tree overlay for EBF6ull uart3 device
 * author : embedfire
 * date : 2019-11-19 
 * version : A001
 */
 
/dts-v1/;
/plugin/;

#include "../imx6ul-pinfunc.h"
#include "../imx6ull-pinfunc.h"
#include "dt-bindings/gpio/gpio.h"
#include "dt-bindings/clock/imx6ul-clock.h"
#include "../imx6ull-pinfunc-snvs.h"
/ {
	fragment@0 {
		target-path = "/";		
		__overlay__ {
				spi4 {
					compatible = "spi-gpio";
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_spi4>;
					pinctrl-assert-gpios = <&gpio5 8 GPIO_ACTIVE_LOW>;
					status = "okay";
					gpio-sck = <&gpio5 11 0>;
					gpio-mosi = <&gpio5 10 0>;
					cs-gpios = <&gpio5 7 0>;
					num-chipselects = <1>;
					#address-cells = <1>;
					#size-cells = <0>;

					gpio_spi: gpio_spi@0 {
						compatible = "fairchild,74hc595";
						gpio-controller;
						#gpio-cells = <2>;
						reg = <0>;
						registers-number = <1>;
						registers-default = /bits/ 8 <0x57>;
						spi-max-frequency = <100000>;
					};
				};

		};

	};

     fragment@2 {
        target=<&i2c2>;
        __overlay__ {
					clock_frequency = <100000>;
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_i2c2>;
					status = "okay"; 
					#address-cells = <1>;
					#size-cells = <0>;        
					ov5640: ov5640@3c {
						compatible = "ovti,ov5640";
						reg = <0x3c>;
						pinctrl-names = "default";
						pinctrl-0 = <&pinctrl_csi1>;
						clocks = <&clks IMX6UL_CLK_CSI>;
						clock-names = "csi_mclk";
						pwn-gpios = <&gpio_spi 6 1>;
						rst-gpios = <&gpio_spi 5 0>;
						csi_id = <0>;
						mclk = <24000000>;
						mclk_source = <0>;
						status = "okay";    
						port {
							ov5640_ep: endpoint {
								remote-endpoint = <&csi1_ep>;
							};
						};
					};          
        };
     };
		fragment@3 {
			target=<&iomuxc>;
			__overlay__ {
						pinctrl_csi1: csi1grp {
							fsl,pins = <
								MX6UL_PAD_CSI_MCLK__CSI_MCLK		0x1b088
								MX6UL_PAD_CSI_PIXCLK__CSI_PIXCLK	0x1b088
								MX6UL_PAD_CSI_VSYNC__CSI_VSYNC		0x1b088
								MX6UL_PAD_CSI_HSYNC__CSI_HSYNC		0x1b088
								MX6UL_PAD_CSI_DATA00__CSI_DATA02	0x1b088
								MX6UL_PAD_CSI_DATA01__CSI_DATA03	0x1b088
								MX6UL_PAD_CSI_DATA02__CSI_DATA04	0x1b088
								MX6UL_PAD_CSI_DATA03__CSI_DATA05	0x1b088
								MX6UL_PAD_CSI_DATA04__CSI_DATA06	0x1b088
								MX6UL_PAD_CSI_DATA05__CSI_DATA07	0x1b088
								MX6UL_PAD_CSI_DATA06__CSI_DATA08	0x1b088
								MX6UL_PAD_CSI_DATA07__CSI_DATA09	0x1b088
							>;
					};

					pinctrl_i2c2: i2c2grp {
						fsl,pins = <
							MX6UL_PAD_UART5_TX_DATA__I2C2_SCL 0x4001b8b0
							MX6UL_PAD_UART5_RX_DATA__I2C2_SDA 0x4001b8b0
						>;
					};
			};
		};
		fragment@4 {
			target = <&csi>;
			__overlay__ {
				status = "okay";  /* 摄像头总线使能 */

				port {
					csi1_ep: endpoint {
						remote-endpoint = <&ov5640_ep>;
					};
				};				
			};		
		};
		fragment@5 {
		target = <&iomuxc_snvs>;
		__overlay__ {
					pinctrl_spi4: spi4grp {
					fsl,pins = <
						MX6ULL_PAD_BOOT_MODE0__GPIO5_IO10		0x70a1
						MX6ULL_PAD_BOOT_MODE1__GPIO5_IO11		0x70a1
						MX6ULL_PAD_SNVS_TAMPER7__GPIO5_IO07		0x70a1
						MX6ULL_PAD_SNVS_TAMPER8__GPIO5_IO08		0x80000000
					>;
				};		

		};
};
